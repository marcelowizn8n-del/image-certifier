import i18n from 'i18next';
import { initReactI18next } from 'react-i18next';
import { NativeModules, Platform } from 'react-native';

const resources = {
  pt: {
    translation: {
      app: { name: 'Image Certifier', tagline: 'Verificação de Autenticidade Digital' },
      tabs: { upload: 'Analisar', history: 'Histórico', subscribe: 'Premium', settings: 'Config' },
      upload: {
        title: 'Análise de Autenticidade',
        subtitle: 'Verifique a integridade digital de mídias',
        selectImage: 'Selecionar Imagem',
        takePhoto: 'Tirar Foto',
        fromUrl: 'URL da Imagem',
        urlPlaceholder: 'Cole a URL aqui',
        analyze: 'Analisar Imagem',
        analyzing: 'Analisando...',
        newAnalysis: 'Nova Análise',
      },
      result: {
        certifiedImage: 'Certificado Digital',
        original: 'Verificado / Autêntico',
        ai_generated: 'Conteúdo Sintético',
        ai_modified: 'Modificado por IA',
        uncertain: 'Análise Inconclusiva',
        confidence: 'Confiança',
        artifacts: 'Artefatos Detectados',
        compression: 'Compressão JPEG',
        blur: 'Desfoque Não Natural',
        colorAdjustment: 'Ajuste de Cor',
        noisePatterns: 'Padrões de Ruído',
        inconsistentLighting: 'Iluminação Inconsistente',
        edgeArtifacts: 'Artefatos de Borda',
        metadata: 'Metadados',
        download: 'Baixar com Selo',
        share: 'Compartilhar',
      },
      history: {
        title: 'Histórico',
        empty: 'Nenhuma análise ainda',
        total: 'Total de Análises',
      },
      settings: {
        title: 'Configurações',
        language: 'Idioma',
        theme: 'Tema',
        dark: 'Escuro',
        light: 'Claro',
        auto: 'Automático',
        about: 'Sobre',
        privacy: 'Privacidade',
        terms: 'Termos de Uso',
        version: 'Versão',
      },
      subscribe: {
        title: 'Assine o Premium',
        subtitle: 'Desbloqueie análises ilimitadas e recursos avançados',
        alreadyPremium: 'Você é Premium!',
        enjoyFeatures: 'Aproveite todos os recursos sem limites.',
        popular: 'Popular',
        analysesPerMonth: 'análises/mês',
        month: 'mês',
        processing: 'Processando compra...',
        restore: 'Restaurar compras',
        legal: 'A assinatura será cobrada na sua conta Apple ID ou Google Play. Renovação automática a menos que seja cancelada 24h antes do fim do período atual. Gerenciar assinatura nas configurações do dispositivo.',
        features: {
          unlimitedAnalyses: 'Análises ilimitadas de imagens',
          priorityProcessing: 'Processamento prioritário',
          advancedDetection: 'Detecção avançada de IA',
          exportReports: 'Exportar relatórios detalhados',
        },
        plans: {
          basic: { name: 'Básico' },
          premium: { name: 'Premium' },
          enterprise: { name: 'Enterprise' },
        },
      },
      common: {
        loading: 'Carregando...',
        error: 'Erro',
        success: 'Sucesso',
        cancel: 'Cancelar',
        save: 'Salvar',
        delete: 'Excluir',
        confirm: 'Confirmar',
      },
    },
  },
  en: {
    translation: {
      app: { name: 'Image Certifier', tagline: 'Digital Authenticity Verification' },
      tabs: { upload: 'Analyze', history: 'History', subscribe: 'Premium', settings: 'Settings' },
      upload: {
        title: 'Authenticity Analysis',
        subtitle: 'Verify digital integrity of media',
        selectImage: 'Select Image',
        takePhoto: 'Take Photo',
        fromUrl: 'Image URL',
        urlPlaceholder: 'Paste URL here',
        analyze: 'Analyze Image',
        analyzing: 'Analyzing...',
        newAnalysis: 'New Analysis',
      },
      result: {
        certifiedImage: 'Digital Certificate',
        original: 'Verified / Authentic',
        ai_generated: 'Synthetic Content',
        ai_modified: 'AI Modified',
        uncertain: 'Inconclusive',
        confidence: 'Confidence',
        artifacts: 'Detected Artifacts',
        compression: 'JPEG Compression',
        blur: 'Unnatural Blur',
        colorAdjustment: 'Color Adjustment',
        noisePatterns: 'Noise Patterns',
        inconsistentLighting: 'Inconsistent Lighting',
        edgeArtifacts: 'Edge Artifacts',
        metadata: 'Metadata',
        download: 'Download with Seal',
        share: 'Share',
      },
      history: {
        title: 'History',
        empty: 'No analyses yet',
        total: 'Total Analyses',
      },
      settings: {
        title: 'Settings',
        language: 'Language',
        theme: 'Theme',
        dark: 'Dark',
        light: 'Light',
        auto: 'Auto',
        about: 'About',
        privacy: 'Privacy',
        terms: 'Terms of Use',
        version: 'Version',
      },
      subscribe: {
        title: 'Go Premium',
        subtitle: 'Unlock unlimited analyses and advanced features',
        alreadyPremium: 'You are Premium!',
        enjoyFeatures: 'Enjoy all features without limits.',
        popular: 'Popular',
        analysesPerMonth: 'analyses/mo',
        month: 'month',
        processing: 'Processing purchase...',
        restore: 'Restore purchases',
        legal: 'Subscription will be charged to your Apple ID or Google Play account. Auto-renews unless cancelled at least 24 hours before the end of the current period. Manage subscription in device settings.',
        features: {
          unlimitedAnalyses: 'Unlimited image analyses',
          priorityProcessing: 'Priority processing',
          advancedDetection: 'Advanced AI detection',
          exportReports: 'Export detailed reports',
        },
        plans: {
          basic: { name: 'Basic' },
          premium: { name: 'Premium' },
          enterprise: { name: 'Enterprise' },
        },
      },
      common: {
        loading: 'Loading...',
        error: 'Error',
        success: 'Success',
        cancel: 'Cancel',
        save: 'Save',
        delete: 'Delete',
        confirm: 'Confirm',
      },
    },
  },
  es: {
    translation: {
      app: { name: 'Image Certifier', tagline: 'Verificación de Autenticidad de Imágenes' },
      tabs: { upload: 'Analizar', history: 'Historial', subscribe: 'Premium', settings: 'Ajustes' },
      upload: {
        title: 'Análisis de Imagen',
        subtitle: 'Sube una imagen para verificar autenticidad',
        selectImage: 'Seleccionar Imagen',
        takePhoto: 'Tomar Foto',
        fromUrl: 'URL de la Imagen',
        urlPlaceholder: 'Pega la URL aquí',
        analyze: 'Analizar Imagen',
        analyzing: 'Analizando...',
        newAnalysis: 'Nuevo Análisis',
      },
      result: {
        certifiedImage: 'Imagen Certificada',
        original: 'Original',
        ai_generated: 'Generada por IA',
        ai_modified: 'Modificada por IA',
        uncertain: 'Incierto',
        confidence: 'Confianza',
        artifacts: 'Artefactos Detectados',
        compression: 'Compresión JPEG',
        blur: 'Desenfoque no Natural',
        colorAdjustment: 'Ajuste de Color',
        noisePatterns: 'Patrones de Ruido',
        inconsistentLighting: 'Iluminación Inconsistente',
        edgeArtifacts: 'Artefactos de Borde',
        metadata: 'Metadatos',
        download: 'Descargar con Sello',
        share: 'Compartir',
      },
      history: {
        title: 'Historial',
        empty: 'Sin análisis aún',
        total: 'Total de Análisis',
      },
      settings: {
        title: 'Ajustes',
        language: 'Idioma',
        theme: 'Tema',
        dark: 'Oscuro',
        light: 'Claro',
        auto: 'Automático',
        about: 'Acerca de',
        privacy: 'Privacidad',
        terms: 'Términos de Uso',
        version: 'Versión',
      },
      subscribe: {
        title: 'Hazte Premium',
        subtitle: 'Desbloquea análisis ilimitados y funciones avanzadas',
        alreadyPremium: '¡Eres Premium!',
        enjoyFeatures: 'Disfruta de todas las funciones sin límites.',
        popular: 'Popular',
        analysesPerMonth: 'análisis/mes',
        month: 'mes',
        processing: 'Procesando compra...',
        restore: 'Restaurar compras',
        legal: 'La suscripción se cobrará en tu cuenta Apple ID o Google Play. Se renueva automáticamente a menos que se cancele 24h antes del final del período actual.',
        features: {
          unlimitedAnalyses: 'Análisis ilimitados de imágenes',
          priorityProcessing: 'Procesamiento prioritario',
          advancedDetection: 'Detección avanzada de IA',
          exportReports: 'Exportar informes detallados',
        },
        plans: {
          basic: { name: 'Básico' },
          premium: { name: 'Premium' },
          enterprise: { name: 'Enterprise' },
        },
      },
      common: {
        loading: 'Cargando...',
        error: 'Error',
        success: 'Éxito',
        cancel: 'Cancelar',
        save: 'Guardar',
        delete: 'Eliminar',
        confirm: 'Confirmar',
      },
    },
  },
  fr: {
    translation: {
      app: { name: 'Image Certifier', tagline: "Vérification d'Authenticité d'Images" },
      tabs: { upload: 'Analyser', history: 'Historique', subscribe: 'Premium', settings: 'Paramètres' },
      upload: {
        title: "Analyse d'Image",
        subtitle: "Téléchargez une image pour vérifier l'authenticité",
        selectImage: 'Sélectionner Image',
        takePhoto: 'Prendre Photo',
        fromUrl: "URL de l'Image",
        urlPlaceholder: "Collez l'URL ici",
        analyze: "Analyser l'Image",
        analyzing: 'Analyse en cours...',
        newAnalysis: 'Nouvelle Analyse',
      },
      result: {
        certifiedImage: 'Image Certifiée',
        original: 'Original',
        ai_generated: 'Générée par IA',
        ai_modified: 'Modifiée par IA',
        uncertain: 'Incertain',
        confidence: 'Confiance',
        artifacts: 'Artefacts Détectés',
        compression: 'Compression JPEG',
        blur: 'Flou Non Naturel',
        colorAdjustment: 'Ajustement de Couleur',
        noisePatterns: 'Motifs de Bruit',
        inconsistentLighting: 'Éclairage Incohérent',
        edgeArtifacts: 'Artefacts de Bordure',
        metadata: 'Métadonnées',
        download: 'Télécharger avec Sceau',
        share: 'Partager',
      },
      history: {
        title: 'Historique',
        empty: "Pas encore d'analyses",
        total: "Total d'Analyses",
      },
      settings: {
        title: 'Paramètres',
        language: 'Langue',
        theme: 'Thème',
        dark: 'Sombre',
        light: 'Clair',
        auto: 'Automatique',
        about: 'À propos',
        privacy: 'Confidentialité',
        terms: "Conditions d'Utilisation",
        version: 'Version',
      },
      subscribe: {
        title: 'Passer Premium',
        subtitle: 'Débloquez des analyses illimitées et des fonctionnalités avancées',
        alreadyPremium: 'Vous êtes Premium !',
        enjoyFeatures: 'Profitez de toutes les fonctionnalités sans limites.',
        popular: 'Populaire',
        analysesPerMonth: 'analyses/mois',
        month: 'mois',
        processing: 'Traitement de l\'achat...',
        restore: 'Restaurer les achats',
        legal: 'L\'abonnement sera facturé sur votre compte Apple ID ou Google Play. Renouvellement automatique sauf annulation 24h avant la fin de la période en cours.',
        features: {
          unlimitedAnalyses: 'Analyses d\'images illimitées',
          priorityProcessing: 'Traitement prioritaire',
          advancedDetection: 'Détection IA avancée',
          exportReports: 'Exporter des rapports détaillés',
        },
        plans: {
          basic: { name: 'Basique' },
          premium: { name: 'Premium' },
          enterprise: { name: 'Enterprise' },
        },
      },
      common: {
        loading: 'Chargement...',
        error: 'Erreur',
        success: 'Succès',
        cancel: 'Annuler',
        save: 'Enregistrer',
        delete: 'Supprimer',
        confirm: 'Confirmer',
      },
    },
  },
  de: {
    translation: {
      app: { name: 'Image Certifier', tagline: 'Bildauthentizitätsprüfung' },
      tabs: { upload: 'Analysieren', history: 'Verlauf', subscribe: 'Premium', settings: 'Einstellungen' },
      upload: {
        title: 'Bildanalyse',
        subtitle: 'Laden Sie ein Bild hoch, um die Authentizität zu überprüfen',
        selectImage: 'Bild auswählen',
        takePhoto: 'Foto aufnehmen',
        fromUrl: 'Bild-URL',
        urlPlaceholder: 'URL hier einfügen',
        analyze: 'Bild analysieren',
        analyzing: 'Analysiere...',
        newAnalysis: 'Neue Analyse',
      },
      result: {
        certifiedImage: 'Zertifiziertes Bild',
        original: 'Original',
        ai_generated: 'KI-generiert',
        ai_modified: 'KI-modifiziert',
        uncertain: 'Unsicher',
        confidence: 'Vertrauen',
        artifacts: 'Erkannte Artefakte',
        compression: 'JPEG-Kompression',
        blur: 'Unnatürliche Unschärfe',
        colorAdjustment: 'Farbanpassung',
        noisePatterns: 'Rauschmuster',
        inconsistentLighting: 'Inkonsistente Beleuchtung',
        edgeArtifacts: 'Kantenartefakte',
        metadata: 'Metadaten',
        download: 'Mit Siegel herunterladen',
        share: 'Teilen',
      },
      history: {
        title: 'Verlauf',
        empty: 'Noch keine Analysen',
        total: 'Gesamtanalysen',
      },
      settings: {
        title: 'Einstellungen',
        language: 'Sprache',
        theme: 'Thema',
        dark: 'Dunkel',
        light: 'Hell',
        auto: 'Automatisch',
        about: 'Über',
        privacy: 'Datenschutz',
        terms: 'Nutzungsbedingungen',
        version: 'Version',
      },
      subscribe: {
        title: 'Premium werden',
        subtitle: 'Unbegrenzte Analysen und erweiterte Funktionen freischalten',
        alreadyPremium: 'Sie sind Premium!',
        enjoyFeatures: 'Genießen Sie alle Funktionen ohne Einschränkungen.',
        popular: 'Beliebt',
        analysesPerMonth: 'Analysen/Monat',
        month: 'Monat',
        processing: 'Kauf wird verarbeitet...',
        restore: 'Käufe wiederherstellen',
        legal: 'Das Abonnement wird Ihrem Apple ID- oder Google Play-Konto belastet. Automatische Verlängerung, sofern nicht mindestens 24 Stunden vor Ende des aktuellen Zeitraums gekündigt.',
        features: {
          unlimitedAnalyses: 'Unbegrenzte Bildanalysen',
          priorityProcessing: 'Priorisierte Verarbeitung',
          advancedDetection: 'Erweiterte KI-Erkennung',
          exportReports: 'Detaillierte Berichte exportieren',
        },
        plans: {
          basic: { name: 'Basis' },
          premium: { name: 'Premium' },
          enterprise: { name: 'Enterprise' },
        },
      },
      common: {
        loading: 'Laden...',
        error: 'Fehler',
        success: 'Erfolg',
        cancel: 'Abbrechen',
        save: 'Speichern',
        delete: 'Löschen',
        confirm: 'Bestätigen',
      },
    },
  },
  zh: {
    translation: {
      app: { name: 'Image Certifier', tagline: '图像真实性验证' },
      tabs: { upload: '分析', history: '历史', subscribe: '高级版', settings: '设置' },
      upload: {
        title: '图像分析',
        subtitle: '上传图像以验证真实性',
        selectImage: '选择图像',
        takePhoto: '拍照',
        fromUrl: '图像URL',
        urlPlaceholder: '在此粘贴URL',
        analyze: '分析图像',
        analyzing: '分析中...',
        newAnalysis: '新分析',
      },
      result: {
        certifiedImage: '认证图片',
        original: '原创',
        ai_generated: 'AI生成',
        ai_modified: 'AI修改',
        uncertain: '不确定',
        confidence: '置信度',
        artifacts: '检测到的伪影',
        compression: 'JPEG 压缩',
        blur: '非自然模糊',
        colorAdjustment: '色彩调整',
        noisePatterns: '噪点模式',
        inconsistentLighting: '光照不一致',
        edgeArtifacts: '边缘伪影',
        metadata: '元数据',
        download: '下载带印章',
        share: '分享',
      },
      history: {
        title: '历史',
        empty: '暂无分析',
        total: '总分析次数',
      },
      settings: {
        title: '设置',
        language: '语言',
        theme: '主题',
        dark: '暗色',
        light: '亮色',
        auto: '自动',
        about: '关于',
        privacy: '隐私',
        terms: '使用条款',
        version: '版本',
      },
      subscribe: {
        title: '升级高级版',
        subtitle: '解锁无限分析和高级功能',
        alreadyPremium: '您已是高级会员！',
        enjoyFeatures: '畅享所有功能，无任何限制。',
        popular: '热门',
        analysesPerMonth: '次分析/月',
        month: '月',
        processing: '正在处理购买...',
        restore: '恢复购买',
        legal: '订阅将从您的 Apple ID 或 Google Play 账户中扣费。除非在当前周期结束前至少24小时取消，否则将自动续订。',
        features: {
          unlimitedAnalyses: '无限图像分析',
          priorityProcessing: '优先处理',
          advancedDetection: '高级AI检测',
          exportReports: '导出详细报告',
        },
        plans: {
          basic: { name: '基础版' },
          premium: { name: '高级版' },
          enterprise: { name: '企业版' },
        },
      },
      common: {
        loading: '加载中...',
        error: '错误',
        success: '成功',
        cancel: '取消',
        save: '保存',
        delete: '删除',
        confirm: '确认',
      },
    },
  },
};

const getDeviceLanguage = (): string => {
  try {
    let locale = 'en';
    if (Platform.OS === 'ios') {
      locale = NativeModules.SettingsManager?.settings?.AppleLocale ||
        NativeModules.SettingsManager?.settings?.AppleLanguages?.[0] ||
        'en';
    } else {
      locale = NativeModules.I18nManager?.localeIdentifier || 'en';
    }
    const lang = locale.split(/[-_]/)[0];
    return ['pt', 'en', 'es', 'fr', 'de', 'zh'].includes(lang) ? lang : 'en';
  } catch {
    return 'en';
  }
};

i18n.use(initReactI18next).init({
  resources,
  lng: getDeviceLanguage(),
  fallbackLng: 'en',
  interpolation: {
    escapeValue: false,
  },
});

export default i18n;
