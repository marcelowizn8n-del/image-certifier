import i18n from 'i18next';
import { initReactI18next } from 'react-i18next';
import { NativeModules, Platform } from 'react-native';

const resources = {
  pt: {
    translation: {
      app: { name: 'Image Certifier', tagline: 'Verificação de Autenticidade de Imagens' },
      tabs: { upload: 'Analisar', history: 'Histórico', settings: 'Config' },
      upload: {
        title: 'Análise de Imagem',
        subtitle: 'Envie uma imagem para verificar autenticidade',
        selectImage: 'Selecionar Imagem',
        takePhoto: 'Tirar Foto',
        fromUrl: 'URL da Imagem',
        urlPlaceholder: 'Cole a URL aqui',
        analyze: 'Analisar Imagem',
        analyzing: 'Analisando...',
        newAnalysis: 'Nova Análise',
      },
      result: {
        certifiedImage: 'Imagem Certificada',
        original: 'Original',
        ai_generated: 'Gerada por IA',
        ai_modified: 'Modificada por IA',
        uncertain: 'Incerto',
        confidence: 'Confiança',
        artifacts: 'Artefatos Detectados',
        metadata: 'Metadados',
        download: 'Baixar com Selo',
        share: 'Compartilhar',
      },
      history: {
        title: 'Histórico',
        empty: 'Nenhuma análise ainda',
        total: 'Total de Análises',
      },
      settings: {
        title: 'Configurações',
        language: 'Idioma',
        theme: 'Tema',
        dark: 'Escuro',
        light: 'Claro',
        auto: 'Automático',
        about: 'Sobre',
        privacy: 'Privacidade',
        terms: 'Termos de Uso',
        version: 'Versão',
      },
      common: {
        loading: 'Carregando...',
        error: 'Erro',
        success: 'Sucesso',
        cancel: 'Cancelar',
        save: 'Salvar',
        delete: 'Excluir',
        confirm: 'Confirmar',
      },
    },
  },
  en: {
    translation: {
      app: { name: 'Image Certifier', tagline: 'Image Authenticity Verification' },
      tabs: { upload: 'Analyze', history: 'History', settings: 'Settings' },
      upload: {
        title: 'Image Analysis',
        subtitle: 'Upload an image to verify authenticity',
        selectImage: 'Select Image',
        takePhoto: 'Take Photo',
        fromUrl: 'Image URL',
        urlPlaceholder: 'Paste URL here',
        analyze: 'Analyze Image',
        analyzing: 'Analyzing...',
        newAnalysis: 'New Analysis',
      },
      result: {
        certifiedImage: 'Certified Image',
        original: 'Original',
        ai_generated: 'AI Generated',
        ai_modified: 'AI Modified',
        uncertain: 'Uncertain',
        confidence: 'Confidence',
        artifacts: 'Detected Artifacts',
        metadata: 'Metadata',
        download: 'Download with Seal',
        share: 'Share',
      },
      history: {
        title: 'History',
        empty: 'No analyses yet',
        total: 'Total Analyses',
      },
      settings: {
        title: 'Settings',
        language: 'Language',
        theme: 'Theme',
        dark: 'Dark',
        light: 'Light',
        auto: 'Auto',
        about: 'About',
        privacy: 'Privacy',
        terms: 'Terms of Use',
        version: 'Version',
      },
      common: {
        loading: 'Loading...',
        error: 'Error',
        success: 'Success',
        cancel: 'Cancel',
        save: 'Save',
        delete: 'Delete',
        confirm: 'Confirm',
      },
    },
  },
  es: {
    translation: {
      app: { name: 'Image Certifier', tagline: 'Verificación de Autenticidad de Imágenes' },
      tabs: { upload: 'Analizar', history: 'Historial', settings: 'Ajustes' },
      upload: {
        title: 'Análisis de Imagen',
        subtitle: 'Sube una imagen para verificar autenticidad',
        selectImage: 'Seleccionar Imagen',
        takePhoto: 'Tomar Foto',
        fromUrl: 'URL de la Imagen',
        urlPlaceholder: 'Pega la URL aquí',
        analyze: 'Analizar Imagen',
        analyzing: 'Analizando...',
        newAnalysis: 'Nuevo Análisis',
      },
      result: {
        certifiedImage: 'Imagen Certificada',
        original: 'Original',
        ai_generated: 'Generada por IA',
        ai_modified: 'Modificada por IA',
        uncertain: 'Incierto',
        confidence: 'Confianza',
        artifacts: 'Artefactos Detectados',
        metadata: 'Metadatos',
        download: 'Descargar con Sello',
        share: 'Compartir',
      },
      history: {
        title: 'Historial',
        empty: 'Sin análisis aún',
        total: 'Total de Análisis',
      },
      settings: {
        title: 'Ajustes',
        language: 'Idioma',
        theme: 'Tema',
        dark: 'Oscuro',
        light: 'Claro',
        auto: 'Automático',
        about: 'Acerca de',
        privacy: 'Privacidad',
        terms: 'Términos de Uso',
        version: 'Versión',
      },
      common: {
        loading: 'Cargando...',
        error: 'Error',
        success: 'Éxito',
        cancel: 'Cancelar',
        save: 'Guardar',
        delete: 'Eliminar',
        confirm: 'Confirmar',
      },
    },
  },
  fr: {
    translation: {
      app: { name: 'Image Certifier', tagline: "Vérification d'Authenticité d'Images" },
      tabs: { upload: 'Analyser', history: 'Historique', settings: 'Paramètres' },
      upload: {
        title: "Analyse d'Image",
        subtitle: "Téléchargez une image pour vérifier l'authenticité",
        selectImage: 'Sélectionner Image',
        takePhoto: 'Prendre Photo',
        fromUrl: "URL de l'Image",
        urlPlaceholder: "Collez l'URL ici",
        analyze: "Analyser l'Image",
        analyzing: 'Analyse en cours...',
        newAnalysis: 'Nouvelle Analyse',
      },
      result: {
        certifiedImage: 'Image Certifiée',
        original: 'Original',
        ai_generated: 'Générée par IA',
        ai_modified: 'Modifiée par IA',
        uncertain: 'Incertain',
        confidence: 'Confiance',
        artifacts: 'Artefacts Détectés',
        metadata: 'Métadonnées',
        download: 'Télécharger avec Sceau',
        share: 'Partager',
      },
      history: {
        title: 'Historique',
        empty: "Pas encore d'analyses",
        total: "Total d'Analyses",
      },
      settings: {
        title: 'Paramètres',
        language: 'Langue',
        theme: 'Thème',
        dark: 'Sombre',
        light: 'Clair',
        auto: 'Automatique',
        about: 'À propos',
        privacy: 'Confidentialité',
        terms: "Conditions d'Utilisation",
        version: 'Version',
      },
      common: {
        loading: 'Chargement...',
        error: 'Erreur',
        success: 'Succès',
        cancel: 'Annuler',
        save: 'Enregistrer',
        delete: 'Supprimer',
        confirm: 'Confirmer',
      },
    },
  },
  de: {
    translation: {
      app: { name: 'Image Certifier', tagline: 'Bildauthentizitätsprüfung' },
      tabs: { upload: 'Analysieren', history: 'Verlauf', settings: 'Einstellungen' },
      upload: {
        title: 'Bildanalyse',
        subtitle: 'Laden Sie ein Bild hoch, um die Authentizität zu überprüfen',
        selectImage: 'Bild auswählen',
        takePhoto: 'Foto aufnehmen',
        fromUrl: 'Bild-URL',
        urlPlaceholder: 'URL hier einfügen',
        analyze: 'Bild analysieren',
        analyzing: 'Analysiere...',
        newAnalysis: 'Neue Analyse',
      },
      result: {
        certifiedImage: 'Zertifiziertes Bild',
        original: 'Original',
        ai_generated: 'KI-generiert',
        ai_modified: 'KI-modifiziert',
        uncertain: 'Unsicher',
        confidence: 'Vertrauen',
        artifacts: 'Erkannte Artefakte',
        metadata: 'Metadaten',
        download: 'Mit Siegel herunterladen',
        share: 'Teilen',
      },
      history: {
        title: 'Verlauf',
        empty: 'Noch keine Analysen',
        total: 'Gesamtanalysen',
      },
      settings: {
        title: 'Einstellungen',
        language: 'Sprache',
        theme: 'Thema',
        dark: 'Dunkel',
        light: 'Hell',
        auto: 'Automatisch',
        about: 'Über',
        privacy: 'Datenschutz',
        terms: 'Nutzungsbedingungen',
        version: 'Version',
      },
      common: {
        loading: 'Laden...',
        error: 'Fehler',
        success: 'Erfolg',
        cancel: 'Abbrechen',
        save: 'Speichern',
        delete: 'Löschen',
        confirm: 'Bestätigen',
      },
    },
  },
  zh: {
    translation: {
      app: { name: 'Image Certifier', tagline: '图像真实性验证' },
      tabs: { upload: '分析', history: '历史', settings: '设置' },
      upload: {
        title: '图像分析',
        subtitle: '上传图像以验证真实性',
        selectImage: '选择图像',
        takePhoto: '拍照',
        fromUrl: '图像URL',
        urlPlaceholder: '在此粘贴URL',
        analyze: '分析图像',
        analyzing: '分析中...',
        newAnalysis: '新分析',
      },
      result: {
        certifiedImage: '认证图片',
        original: '原创',
        ai_generated: 'AI生成',
        ai_modified: 'AI修改',
        uncertain: '不确定',
        confidence: '置信度',
        artifacts: '检测到的伪影',
        metadata: '元数据',
        download: '下载带印章',
        share: '分享',
      },
      history: {
        title: '历史',
        empty: '暂无分析',
        total: '总分析次数',
      },
      settings: {
        title: '设置',
        language: '语言',
        theme: '主题',
        dark: '暗色',
        light: '亮色',
        auto: '自动',
        about: '关于',
        privacy: '隐私',
        terms: '使用条款',
        version: '版本',
      },
      common: {
        loading: '加载中...',
        error: '错误',
        success: '成功',
        cancel: '取消',
        save: '保存',
        delete: '删除',
        confirm: '确认',
      },
    },
  },
};

const getDeviceLanguage = (): string => {
  try {
    let locale = 'en';
    if (Platform.OS === 'ios') {
      locale = NativeModules.SettingsManager?.settings?.AppleLocale ||
               NativeModules.SettingsManager?.settings?.AppleLanguages?.[0] ||
               'en';
    } else {
      locale = NativeModules.I18nManager?.localeIdentifier || 'en';
    }
    const lang = locale.split(/[-_]/)[0];
    return ['pt', 'en', 'es', 'fr', 'de', 'zh'].includes(lang) ? lang : 'en';
  } catch {
    return 'en';
  }
};

i18n.use(initReactI18next).init({
  resources,
  lng: getDeviceLanguage(),
  fallbackLng: 'en',
  interpolation: {
    escapeValue: false,
  },
});

export default i18n;
